imports:
  Merchant: Domain.Types.Merchant
  MerchantOperatingCity: Domain.Types.MerchantOperatingCity
  Person: Domain.Types.Person
  DbHash: Kernel.External.Encryption

AadhaarVerification:
  tableName: aadhaar_verification

  derives: "Generic, ToJSON, FromJSON, Show"

  fields:
    personName : Text
    personId : Id Person
    personGender : Text
    personDob : Text
    personImagePath : Maybe Text
    aadhaarNumberHash : Maybe DbHash
    isVerified : Bool
    createdAt : UTCTime
    updatedAt : UTCTime

  queries:
    findByPersonId:
      kvFunction: findOneWithKV
      where: personId

    findByAadhaarNumberHash:
      kvFunction: findOneWithKV
      where: aadhaarNumberHash

    findByPhoneNumberAndUpdate:
      kvFunction: updateWithKV
      params: [personName, personGender, personDob, aadhaarNumberHash, isVerified, updatedAt]
      where: personId

    deleteByPersonId:
      kvFunction: deleteWithKV
      where: personId

    updatePersonImagePath:
      kvFunction: updateOneWithKV
      params: [personImagePath]
      where: personId

  constraints:
    personId: PrimaryKey
    aadhaarNumberHash: SecondaryKey

  excludedFields: [merchantId, merchantOperatingCityId]